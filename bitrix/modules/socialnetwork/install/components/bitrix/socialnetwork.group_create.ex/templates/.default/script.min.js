function BXSwitchProject(e){BX.BXGCE.recalcFormPartProject(e)}function BXSwitchNotVisible(e){if(BX("GROUP_OPENED")&&BX("GROUP_OPENED").type=="checkbox"){if(e){BX("GROUP_OPENED").disabled=false}else{BX("GROUP_OPENED").disabled=true;BX("GROUP_OPENED").checked=false}}}function BXSwitchExtranet(e,t){if(BX("INVITE_EXTRANET_block")){if(e){BX("INVITE_EXTRANET_block_container").style.display="block"}BX.BXGCE.showHideBlock({container:BX("INVITE_EXTRANET_block_container"),block:BX("INVITE_EXTRANET_block"),show:e,duration:t?1e3:0,callback:{complete:function(){if(e){BX.removeClass(BX("INVITE_EXTRANET_block_container"),"invisible")}else{BX("INVITE_EXTRANET_block_container").style.display="none";BX.addClass(BX("INVITE_EXTRANET_block_container"),"invisible")}}}})}if(BX("GROUP_OPENED")){if(!e){if(BX("GROUP_OPENED").type=="checkbox"){BX("GROUP_OPENED").disabled=false}}else{if(BX("GROUP_OPENED").type=="checkbox"){BX("GROUP_OPENED").disabled=true;BX("GROUP_OPENED").checked=false}else{BX("GROUP_OPENED").value="N"}}}if(BX("GROUP_VISIBLE")){if(!e){if(BX("GROUP_VISIBLE").type=="checkbox"){BX("GROUP_VISIBLE").disabled=false}}else{if(BX("GROUP_VISIBLE").type=="checkbox"){BX("GROUP_VISIBLE").disabled=true;BX("GROUP_VISIBLE").checked=false}else{BX("GROUP_VISIBLE").value="N"}}}if(BX("GROUP_INITIATE_PERMS")&&BX("GROUP_INITIATE_PERMS_OPTION_E")&&BX("GROUP_INITIATE_PERMS_OPTION_K")){if(e){BX("GROUP_INITIATE_PERMS_OPTION_E").selected=true}else{BX("GROUP_INITIATE_PERMS_OPTION_K").selected=true}}if(BX("GROUP_INITIATE_PERMS_PROJECT")&&BX("GROUP_INITIATE_PERMS_OPTION_PROJECT_E")&&BX("GROUP_INITIATE_PERMS_OPTION_PROJECT_K")){if(e){BX("GROUP_INITIATE_PERMS_OPTION_PROJECT_E").selected=true}else{BX("GROUP_INITIATE_PERMS_OPTION_PROJECT_K").selected=true}}if(BX("USERS_employee_section_extranet")){BX("USERS_employee_section_extranet").style.display=e?"inline-block":"none"}}function BXGCESubmitForm(e){if(BX("EXTRANET_INVITE_ACTION")){BX("EXTRANET_INVITE_ACTION").value=BX.BXGCE.lastAction}var t=BX("sonet_group_create_popup_form").action;if(t){if(BX("SONET_GROUP_ID")&&parseInt(BX("SONET_GROUP_ID").value)<=0){t+=(t.indexOf("?")>=0?"&":"?")+"action=createGroup&groupType="+BX.BXGCE.selectedTypeCode}BX.BXGCE.disableSubmitButton(true);BX.ajax.submitAjax(document.forms.sonet_group_create_popup_form,{url:t,method:"POST",dataType:"json",onsuccess:function(e){if(typeof e["ERROR"]!="undefined"&&e["ERROR"].length>0){BX.BXGCE.showError((typeof e["WARNING"]!="undefined"&&e["WARNING"].length>0?e["WARNING"]+"<br>":"")+e["ERROR"]);if(typeof BX.SocNetLogDestination.obItems!="undefined"&&typeof e["USERS_ID"]!="undefined"&&BX.type.isArray(e["USERS_ID"])){var t=false;var o=[];var i=false;var n=0;for(n=0;n<e["USERS_ID"].length;n++){o["U"+e["USERS_ID"][n]]="users"}if(BX.BXGCE.arUserSelector.length>0){for(var a=0;a<BX.BXGCE.arUserSelector.length;a++){t=BX.findChildren(BX("sonet_group_create_popup_users_item_post_"+BX.BXGCE.arUserSelector[a]),{className:"feed-add-post-destination-users"},true);if(t){for(n=0;n<t.length;n++){i=t[n].getAttribute("data-id");if(i&&i.length>0){BX.SocNetLogDestination.deleteItem(i,"users",BX.BXGCE.arUserSelector[a])}}}BX.SocNetLogDestination.obItemsSelected[BX.BXGCE.arUserSelector[a]]=o;BX.SocNetLogDestination.reInit(BX.BXGCE.arUserSelector[a])}}}BX.BXGCE.disableSubmitButton(false)}else if(e["MESSAGE"]=="SUCCESS"){if(typeof e.GROUP!="undefined"){var s={code:"afterCreateEdit",data:{group:e.GROUP}};window.top.BX.onCustomEvent(window.top,"sonetGroupEvent",[s]);window.top.BX.SidePanel.Instance.postMessageAll(window,"sonetGroupEvent",s)}if(BX.BXGCE.config.refresh!="N"){if(typeof e["URL"]!=="undefined"&&e["URL"].length>0){top.location.href=e["URL"]}else{if(typeof top.BX.SidePanel!="undefined"&&top.BX.SidePanel.Instance.isOpen()){top.location.href=top.BX.SidePanel.Instance.getPageUrl()}else{BX.reload()}}}else{window.top.BX.onCustomEvent("BX.Bitrix24.PageSlider:close",[false]);window.top.BX.onCustomEvent("onSonetIframeCancelClick")}}},onfailure:function(e){BX.BXGCE.disableSubmitButton(false);BX.BXGCE.showError(BX.message("SONET_GCE_T_AJAX_ERROR"))}})}e.preventDefault()}function __deleteExtranetEmail(e){var t=false;if(!e||!BX.type.isDomNode(e))e=this;if(e){BX(e).parentNode.parentNode.removeChild(BX(e).parentNode);var o=parseInt(BX(e).parentNode.id.substring(36));top.BXExtranetMailList[o-1]="";BX("EMAILS").value="";for(var i=0;i<top.BXExtranetMailList.length;i++){if(top.BXExtranetMailList[i].length>0){if(t)BX("EMAILS").value+=", ";BX("EMAILS").value+=top.BXExtranetMailList[i];t=true}}}}(function(){if(!!BX.BXGCE){return}BX.BXGCE={config:{refresh:"Y"},groupId:null,userSelector:"",lastAction:"invite",arUserSelector:[],formSteps:2,animationList:{},selectedTypeCode:false};BX.BXGCE.init=function(e){if(typeof e!="undefined"){if(typeof e.groupId!="undefined"){this.groupId=parseInt(e.groupId)}if(typeof e.config!="undefined"){this.config=e.config}}var t=null,o=null;if(BX("sonet_group_create_form_step_1")){var i=BX.findChildren(BX("sonet_group_create_form_step_1"),{className:"social-group-tile-item"},true);for(t=0,o=i.length;t<o;t++){BX.bind(i[t],"click",BX.delegate(function(e){var t=e.currentTarget;var o=this.selectedTypeCode=t.getAttribute("bx-type");if(BX.type.isNotEmptyString(o)){this.showStep({step:2});this.recalcForm({type:o})}e.preventDefault()},this))}}BX.bind(BX("sonet_group_create_popup_form_button_step_2_back"),"click",BX.delegate(function(){this.showStep({step:1})},this));BX.bind(BX("sonet_group_create_popup_form_button_submit"),"click",BXGCESubmitForm);BX.bind(BX("sonet_group_create_popup_form_button_step_2_cancel"),"click",function(e){window.top.BX.onCustomEvent("BX.Bitrix24.PageSlider:close",[false]);window.top.BX.onCustomEvent("onSonetIframeCancelClick");return e.preventDefault()});if(typeof top.BX.Bitrix24!="undefined"&&top.BX.Bitrix24.Slider.getCurrentPage()){BX.addCustomEvent(top.BX.Bitrix24.Slider.getCurrentPage().getWindow(),"BX.Bitrix24.PageSlider:onClose",function(e){setTimeout(function(){top.BX.Bitrix24.Slider.destroy(e.getUrl())},500)})}BX.bind(BX("GROUP_INITIATE_PERMS"),"change",BX.BXGCE.onInitiatePermsChange);BX.bind(BX("GROUP_INITIATE_PERMS_PROJECT"),"change",BX.BXGCE.onInitiatePermsChange);if(BX("GROUP_MODERATORS_switch")&&BX("GROUP_MODERATORS_PROJECT_switch")){var n=BX.delegate(function(){var e=BX.hasClass(BX("GROUP_MODERATORS_block_container"),"invisible");if(e){BX("GROUP_MODERATORS_block_container").style.display="block"}this.showHideBlock({container:BX("GROUP_MODERATORS_block_container"),block:BX("GROUP_MODERATORS_block"),show:e,duration:500,callback:{complete:function(){if(!e){BX("GROUP_MODERATORS_block_container").style.display="none"}BX.toggleClass(BX("GROUP_MODERATORS_block_container"),"invisible")}}})},this);BX.bind(BX("GROUP_MODERATORS_switch"),"click",n);BX.bind(BX("GROUP_MODERATORS_PROJECT_switch"),"click",n)}if(BX("IS_EXTRANET_GROUP")&&BX("IS_EXTRANET_GROUP").type=="checkbox"){BX.bind(BX("IS_EXTRANET_GROUP"),"click",function(){BXSwitchExtranet(BX("IS_EXTRANET_GROUP").checked,true)})}if(BX("GROUP_VISIBLE")&&BX("GROUP_VISIBLE").type=="checkbox"){BX.bind(BX("GROUP_VISIBLE"),"click",function(){BXSwitchNotVisible(BX("GROUP_VISIBLE").checked)})}if(BX("switch_additional")){BX.bind(BX("switch_additional"),"click",BX.delegate(function(e){var t=BX.getEventTarget(e).getAttribute("bx-block-id");if(BX.type.isNotEmptyString(t)){if(!BX.hasClass(BX("switch_additional"),"opened")){this.onToggleAdditionalBlock({callback:BX.delegate(function(){this.highlightAdditionalBlock(t)},this)})}else{this.highlightAdditionalBlock(t)}}else{this.onToggleAdditionalBlock()}},this))}};BX.BXGCE.onToggleAdditionalBlock=function(e){BX.toggleClass(BX("switch_additional"),"opened");var t=BX.hasClass(BX("block_additional"),"invisible");if(t){BX("block_additional").style.display="block"}this.showHideBlock({container:BX("block_additional"),block:BX("block_additional_inner"),show:t,duration:1e3,callback:{complete:function(){BX.toggleClass(BX("block_additional"),"invisible");if(typeof e!="undefined"&&typeof e.callback=="function"){if(!t){BX("block_additional").style.display="none"}e.callback()}}}})};BX.BXGCE.showHideBlock=function(e){if(typeof e=="undefined"){return false}var t=typeof e.container!="undefined"?BX(e.container):false;var o=typeof e.block!="undefined"?BX(e.block):false;var i=!!e.show;if(!t||!o){return false}if(typeof this.animationList[o.id]!="undefined"&&this.animationList[o.id]!=null){return false}this.animationList[o.id]=null;var n=parseInt(o.offsetHeight);var a=typeof e.duration!="undefined"&&parseInt(e.duration)>0?parseInt(e.duration):0;if(i){t.style.display="block"}if(a>0){if(BX.type.isNotEmptyString(o.id)){this.animationList[o.id]=true}BX.delegate(new BX["easing"]({duration:a,start:{height:i?0:n,opacity:i?0:100},finish:{height:i?n:0,opacity:i?100:0},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(e){t.style.maxHeight=e.height+"px";t.style.opacity=e.opacity/100},complete:BX.delegate(function(){if(BX.type.isNotEmptyString(o.id)){this.animationList[o.id]=null}if(typeof e.callback!="undefined"&&typeof e.callback.complete=="function"){t.style.maxHeight="";t.style.opacity="";e.callback.complete()}},this)}).animate(),this)}else{e.callback.complete()}return true};BX.BXGCE.highlightAdditionalBlock=function(e){var t=BX("additional-block-"+e);if(t){var o="item-highlight";var i=BX.GetWindowScrollPos();BX.addClass(t,o);setTimeout(function(){var e=BX.pos(t);new BX.easing({duration:500,start:{scroll:i.scrollTop},finish:{scroll:e.top},transition:BX.easing.makeEaseOut(BX.easing.transitions.quart),step:function(e){window.scrollTo(0,e.scroll)},complete:function(){}}).animate()},600);setTimeout(function(){BX.removeClass(t,o)},3e3)}};BX.BXGCE.onInitiatePermsChange=function(){var e=this.id=="GROUP_INITIATE_PERMS"?"GROUP_INITIATE_PERMS_OPTION_PROJECT_":"GROUP_INITIATE_PERMS_OPTION_";if(BX(e+this.options[this.selectedIndex].value)){BX(e+this.options[this.selectedIndex].value).selected=true}};BX.BXGCE.showStep=function(e){var t=typeof e!="undefined"&&typeof e.step!="undefined"?parseInt(e.step):1;for(var o=1;o<=this.formSteps;o++){if(BX("sonet_group_create_form_step_"+o)){BX("sonet_group_create_form_step_"+o).style.display=o==t?"block":"none"}}};BX.BXGCE.recalcFormPartProjectBlock=function(e,t){if(BX(e)){if(t){BX.addClass(BX(e),"sgcp-switch-project")}else{BX.removeClass(e,"sgcp-switch-project")}}};BX.BXGCE.recalcFormPartProject=function(e){e=!!e;if(BX("GROUP_PROJECT")){this.setCheckedValue(BX("GROUP_PROJECT"),e)}BX.BXGCE.recalcFormPartProjectBlock("IS_PROJECT_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_VISIBLE_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_OPENED_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_CLOSED_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_EXTRANET_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_OWNER_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_MODERATORS_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_MODERATORS_SWITCH_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_TYPE_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_SUBJECT_ID_LABEL_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_INVITE_PERMS_block",e);BX.BXGCE.recalcFormPartProjectBlock("GROUP_INVITE_PERMS_LABEL_block",e);if(BX("sonet_group_create_popup_form_button_submit")&&BX("sonet_group_create_popup_form_button_submit").getAttribute("bx-action-type")=="create"){BX("sonet_group_create_popup_form_button_submit").innerHTML=BX.message(e?"SONET_GCE_T_DO_CREATE_PROJECT":"SONET_GCE_T_DO_CREATE")}if(BX("GROUP_NAME_input")){BX("GROUP_NAME_input").placeholder=BX.message(e?"SONET_GCE_T_NAME2_PROJECT":"SONET_GCE_T_NAME2")}if(BX("pagetitle-slider")){BX("pagetitle-slider").innerHTML=BX.message(this.groupId>0?e?"SONET_GCE_T_TITLE_EDIT_PROJECT":"SONET_GCE_T_TITLE_EDIT":e?"SONET_GCE_T_TITLE_CREATE_PROJECT":"SONET_GCE_T_TITLE_CREATE")}};BX.BXGCE.recalcForm=function(e){var t=typeof e!="undefined"&&typeof e.type!="undefined"?e.type:false;if(!t||typeof this.types[t]=="undefined"){return}this.recalcFormPartProject(this.types[t].PROJECT=="Y");if(BX("GROUP_OPENED")){this.setCheckedValue(BX("GROUP_OPENED"),this.types[t].OPENED=="Y")}if(BX("GROUP_VISIBLE")){this.setCheckedValue(BX("GROUP_VISIBLE"),this.types[t].VISIBLE=="Y")}if(BX("IS_EXTRANET_GROUP")){this.setCheckedValue(BX("IS_EXTRANET_GROUP"),this.types[t].EXTERNAL=="Y")}this.recalcFormDependencies()};BX.BXGCE.recalcFormDependencies=function(){if(BX("IS_EXTRANET_GROUP")){BXSwitchExtranet(this.getCheckedValue(BX("IS_EXTRANET_GROUP")),false)}if(BX("GROUP_VISIBLE")&&BX("GROUP_OPENED")){var e=this.getCheckedValue(BX("GROUP_VISIBLE"));if(!e){this.setCheckedValue(BX("GROUP_OPENED"),false)}}};BX.BXGCE.setSelector=function(e){BX.BXGCE.userSelector=e};BX.BXGCE.disableBackspace=function(e){if(BX.SocNetLogDestination.backspaceDisable||BX.SocNetLogDestination.backspaceDisable!=null){BX.unbind(window,"keydown",BX.SocNetLogDestination.backspaceDisable)}BX.bind(window,"keydown",BX.SocNetLogDestination.backspaceDisable=function(e){if(e.keyCode==8){e.preventDefault();return false}});setTimeout(function(){BX.unbind(window,"keydown",BX.SocNetLogDestination.backspaceDisable);BX.SocNetLogDestination.backspaceDisable=null},5e3)};BX.BXGCE.selectCallback=function(e,t,o,i,n){var a=typeof BX.BXGCESelectorManager.controls[n]!="undefined"&&typeof BX.BXGCESelectorManager.controls[n].single!="undefined"&&!!BX.BXGCESelectorManager.controls[n].single;var s=typeof BX.BXGCESelectorManager.controls[n]!="undefined"&&typeof BX.BXGCESelectorManager.controls[n].controlName!="undefined"&&BX.BXGCESelectorManager.controls[n].controlName?BX.BXGCESelectorManager.controls[n].controlName:"USER_CODES[]";if(!BX.findChild(BX("sonet_group_create_popup_users_item_post_"+n),{attr:{"data-id":e.id}},false,false)){if(a){BX.cleanNode(BX("sonet_group_create_popup_users_item_post_"+n));BX("sonet_group_create_popup_users_input_post_"+n).style.display="none"}BX("sonet_group_create_popup_users_item_post_"+n).appendChild(BX.create("span",{attrs:{"data-id":e.id},props:{className:"feed-add-post-destination feed-add-post-destination-"+t},children:[BX.create("input",{attrs:{type:"hidden",name:s,value:e.id}}),BX.create("span",{props:{className:"feed-add-post-destination-text"},html:e.name}),BX.create("span",{props:{className:"feed-add-post-del-but"},events:{click:function(o){BX.SocNetLogDestination.deleteItem(e.id,t,n);o.preventDefault()},mouseover:function(){BX.addClass(this.parentNode,"feed-add-post-destination-hover")},mouseout:function(){BX.removeClass(this.parentNode,"feed-add-post-destination-hover")}}})]}))}BX("sonet_group_create_popup_users_input_post_"+n).value="";if(!a){BX.SocNetLogDestination.BXfpSetLinkName({formName:n,tagInputName:"sonet_group_create_popup_users_tag_post_"+n,tagLink1:BX.message("SONET_GCE_T_DEST_LINK_1"),tagLink2:BX.message("SONET_GCE_T_DEST_LINK_2")})}else{BX.style(BX("sonet_group_create_popup_users_tag_post_"+n),"display","none");BX.SocNetLogDestination.closeDialog()}};BX.BXGCE.unSelectCallback=function(e,t,o,i){var n=typeof BX.BXGCESelectorManager.controls[i]!="undefined"&&typeof BX.BXGCESelectorManager.controls[i].single!="undefined"&&!!BX.BXGCESelectorManager.controls[i].single;var a=typeof BX.BXGCESelectorManager.controls[i]!="undefined"&&typeof BX.BXGCESelectorManager.controls[i].tagLinkText1!="undefined"&&BX.BXGCESelectorManager.controls[i].tagLinkText1.length>0?BX.BXGCESelectorManager.controls[i].tagLinkText1:BX.message("SONET_GCE_T_DEST_LINK_1");var s=typeof BX.BXGCESelectorManager.controls[i]!="undefined"&&typeof BX.BXGCESelectorManager.controls[i].tagLinkText2!="undefined"&&BX.BXGCESelectorManager.controls[i].tagLinkText2.length>0?BX.BXGCESelectorManager.controls[i].tagLinkText2:BX.message("SONET_GCE_T_DEST_LINK_2");BX.delegate(BX.SocNetLogDestination.BXfpUnSelectCallback,{formName:i,inputContainerName:"sonet_group_create_popup_users_item_post_"+i,inputName:"sonet_group_create_popup_users_input_post_"+i,tagInputName:"sonet_group_create_popup_users_tag_post_"+i,tagLink1:a,tagLink2:s})(e);if(!n){BX.SocNetLogDestination.BXfpSetLinkName({formName:i,tagInputName:"sonet_group_create_popup_users_tag_post_"+i,tagLink1:BX.message("SONET_GCE_T_DEST_LINK_1"),tagLink2:BX.message("SONET_GCE_T_DEST_LINK_2")})}else{BX.style(BX("sonet_group_create_popup_users_tag_post_"+i),"display","inline-block")}};BX.BXGCE.openDialogCallback=function(e){BX.PopupWindow.setOptions({popupZindex:2100});var t=typeof BX.BXGCESelectorManager.controls[e]!="undefined"&&typeof BX.BXGCESelectorManager.controls[e].single!="undefined"&&!!BX.BXGCESelectorManager.controls[e].single;if(t){BX("sonet_group_create_popup_users_input_post_"+e).style.display="inline-block"}BX.SocNetLogDestination.BXfpOpenDialogCallback.apply(this,arguments)};BX.BXGCE.bindActionLink=function(e){if(e===undefined||e==null){return}BX.bind(e,"click",function(t){BX.PopupMenu.destroy("invite-dialog-usertype-popup");var o=[{text:BX.message("SONET_GCE_T_DEST_EXTRANET_SELECTOR_INVITE"),id:"sonet_group_create_popup_action_invite",className:"menu-popup-no-icon",onclick:function(){BX.BXGCE.onActionSelect("invite")}},{text:BX.message("SONET_GCE_T_DEST_EXTRANET_SELECTOR_ADD"),id:"sonet_group_create_popup_action_add",className:"menu-popup-no-icon",onclick:function(){BX.BXGCE.onActionSelect("add")}}];var i={offsetLeft:-14,offsetTop:4,zIndex:1200,lightShadow:false,angle:{position:"top",offset:50},events:{onPopupShow:function(e){}}};BX.PopupMenu.show("sonet_group_create_popup_action_popup",e,o,i)})};BX.BXGCE.onActionSelect=function(e){if(e!="add"){e="invite"}BX.BXGCE.lastAction=e;BX("sonet_group_create_popup_action_title_link").innerHTML=BX.message("SONET_GCE_T_DEST_EXTRANET_SELECTOR_"+(e=="invite"?"INVITE":"ADD"));if(e=="invite"){BX("sonet_group_create_popup_action_block_invite").style.display="block";BX("sonet_group_create_popup_action_block_invite_2").style.display="block";BX("sonet_group_create_popup_action_block_add").style.display="none"}else{BX("sonet_group_create_popup_action_block_invite").style.display="none";BX("sonet_group_create_popup_action_block_invite_2").style.display="none";BX("sonet_group_create_popup_action_block_add").style.display="block"}BX("sonet_group_create_popup_action_block_"+e).style.display="block";BX("sonet_group_create_popup_action_block_"+(e=="invite"?"add":"invite")).style.display="none";BX.PopupMenu.destroy("sonet_group_create_popup_action_popup")};BX.BXGCE.showError=function(e){if(BX("sonet_group_create_error_block")){BX("sonet_group_create_error_block").innerHTML=e;BX("sonet_group_create_error_block").style.display="block"}};BX.BXGCE.showMessage=function(){};BX.BXGCE.disableSubmitButton=function(e){e=!!e;var t=BX("sonet_group_create_popup_form_button_submit");if(t){if(e){BX.addClass(t,"popup-window-button-disabled");BX.addClass(t,"popup-window-button-wait");t.style.cursor="auto";BX.unbind(t,"click",BXGCESubmitForm)}else{BX.removeClass(t,"popup-window-button-disabled");BX.removeClass(t,"popup-window-button-wait");t.style.cursor="pointer";BX.bind(t,"click",BXGCESubmitForm)}}};BX.BXGCE.getCheckedValue=function(e){var t=false;if(!BX(e)){return t}if(e.type=="hidden"){t=e.value=="Y"}else if(e.type=="checkbox"){t=e.checked}return t};BX.BXGCE.setCheckedValue=function(e,t){if(!BX(e)){return}t=!!t;if(e.type=="checkbox"){e.checked=t}else{e.value=t?"Y":"N"}};BX.BXGCETagsForm=function(e){this.popup=null;this.addNewLink=null;this.hiddenField=null;this.popupContent=null;this.init(e)};BX.BXGCETagsForm.prototype.init=function(e){this.addNewLink=BX(e.addNewLinkId);this.tagsContainer=BX(e.containerNodeId);this.hiddenField=BX(e.hiddenFieldId);this.popupContent=BX(e.popupContentNodeId);this.popupInput=BX.findChild(this.popupContent,{tag:"input"});var t=BX.findChildren(this.tagsContainer,{className:"js-id-tdp-mem-sel-is-item-delete"},true);for(var o=0,i=t.length;o<i;o++){BX.bind(t[o],"click",BX.proxy(this.onTagDelete,{obj:this,tagBox:t[o].parentNode.parentNode,tagValue:t[o].parentNode.parentNode.getAttribute("data-tag")}))}BX.bind(this.addNewLink,"click",BX.proxy(this.onAddNewClick,this))};BX.BXGCETagsForm.prototype.onTagDelete=function(){BX.remove(this.tagBox);this.obj.hiddenField.value=this.obj.hiddenField.value.replace(this.tagValue+",","").replace("  "," ")};BX.BXGCETagsForm.prototype.show=function(){if(this.popup===null){this.popup=new BX.PopupWindow("bx-group-tag-popup",this.addNewLink,{content:this.popupContent,lightShadow:false,offsetTop:8,offsetLeft:10,autoHide:true,angle:true,closeByEsc:true,zIndex:-840,buttons:[new BX.PopupWindowButton({text:BX.message("SONET_GCE_T_TAG_ADD"),events:{click:BX.proxy(this.onTagAdd,this)}})]});BX.bind(this.popupInput,"keydown",BX.proxy(this.onKeyPress,this));BX.bind(this.popupInput,"keyup",BX.proxy(this.onKeyPress,this))}this.popup.show();BX.focus(this.popupInput)};BX.BXGCETagsForm.prototype.addTag=function(e){var t=BX.type.isNotEmptyString(e)?e.split(","):this.popupInput.value.split(",");var o=[];for(var i=0;i<t.length;i++){var n=BX.util.trim(t[i]);if(n.length>0){var a=this.hiddenField.value.split(",");if(!BX.util.in_array(n,a)){var s=null;var r=BX.create("span",{children:[BX.create("span",{props:{className:"js-id-tdp-mem-sel-is-item social-group-create-form-field-item"},children:[BX.create("a",{props:{className:"social-group-create-form-field-item-text"},text:n}),s=BX.create("span",{props:{className:"js-id-tdp-mem-sel-is-item-delete social-group-create-form-field-item-delete"}})]})],attrs:{"data-tag":n},props:{className:"js-id-tdp-mem-sel-is-items social-group-create-sliders-h-invisible"}});this.tagsContainer.insertBefore(r,this.addNewLink);BX.bind(s,"click",BX.proxy(this.onTagDelete,{obj:this,tagBox:r,tagValue:n}));this.hiddenField.value+=n+",";o.push(n)}}}return o};BX.BXGCETagsForm.prototype.onTagAdd=function(){this.addTag();this.popupInput.value="";this.popup.close()};BX.BXGCETagsForm.prototype.onAddNewClick=function(e){e=e||window.event;this.show();e.preventDefault()};BX.BXGCETagsForm.prototype.onKeyPress=function(e){e=e||window.event;var t=e.keyCode?e.keyCode:e.which?e.which:null;if(t==13){setTimeout(BX.proxy(this.onTagAdd,this),0)}};BX.BXGCESelectorInstance=function(e){this.single=typeof e!="undefined"&&typeof e.single!="undefined"&&!!e.single;this.controlName=typeof e!="undefined"&&typeof e.controlName!="undefined"?e.controlName:false;this.tagLinkText1=typeof e!="undefined"&&typeof e.tagLinkText1!="undefined"?e.tagLinkText1:"";this.tagLinkText2=typeof e!="undefined"&&typeof e.tagLinkText2!="undefined"?e.tagLinkText2:""};BX.BXGCESelectorInstance.prototype.init=function(e){BX.bind(BX(e.contId),"click",function(){var t=typeof e.id!="undefined"&&typeof BX.BXGCESelectorManager.controls[e.id]!="undefined"&&typeof BX.BXGCESelectorManager.controls[e.id].single!="undefined"&&!!BX.BXGCESelectorManager.controls[e.id].single;if(!t||BX("sonet_group_create_popup_users_item_post_"+e.id)&&BX("sonet_group_create_popup_users_item_post_"+e.id).children.length<=0){BX.onCustomEvent(window,"BX.BXGCE:open",[e])}})};BX.BXGCESelectorManager={controls:{}}})();